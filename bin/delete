#!/usr/bin/env php
<?php
use Everyman\Neo4j\Client,
	Everyman\Neo4j\Index\NodeIndex,
	Everyman\Neo4j\Relationship,
	Everyman\Neo4j\Node,
	Everyman\Neo4j\Gremlin,
	Tokenizer\Token;

include_once(dirname(__DIR__).'/library/Autoload.php');
spl_autoload_register('Autoload::autoload_library');

$client = new Client();

$args = $argv;
if ($id = array_search('-all', $args)) {
    define('FORMAT', 'ALL');
} elseif ($id = array_search('-file', $args)) {
    define('FORMAT', 'FILE');
} else {
    die("Need an option to run. Aborting\n");
}

if (FORMAT == 'ALL') {
    $queryTemplate = "g.E.each{ g.removeEdge(it); }";
    $params = array('type' => 'IN');
    $query = new Gremlin\Query($client, $queryTemplate, $params);
    $edges = $query->getResultSet();

    $queryTemplate = "g.V.each{ g.removeVertex(it); }";
    $params = array('type' => 'IN');
    $query = new Gremlin\Query($client, $queryTemplate, $params);
    $edges = $query->getResultSet();
    
    // Also clean index
} elseif (FORMAT == 'FILE') {
    die("Unknow delete format of '".FORMAT."'. Aborting\n");
    // Also clean index
} else {
    die("Unknow delete format of '".FORMAT."'. Aborting\n");
}


?>